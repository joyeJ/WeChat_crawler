
                        

                        

                        
                        
                        <blockquote style="font-size: 16px; white-space: normal; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">来自：MrLinFeng - 博客园</span></strong></span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">链接：www.cnblogs.com/mrlinfeng/p/6146866.html<strong style="max-width: 100%; font-size: 16px; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(217, 33, 66); box-sizing: border-box !important; word-wrap: break-word !important;">（点击尾部阅读原文前往）</span></strong></span></strong></span></strong></span></p></blockquote><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">相关知识自行搜索，直接上干货。。。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><blockquote style="font-size: 16px; white-space: normal; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">使用的资源：</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">nginx主服务器一台，nginx备服务器一台，使用keepalived进行宕机切换。</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">tomcat服务器两台，由nginx进行反向代理和负载均衡，此处可搭建服务器集群。</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">redis服务器一台，用于session的分离共享。</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">nginx主服务器：192.168.50.133</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">nginx备服务器：192.168.50.135</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">tomcat项目服务器1:192.168.50.137</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">tomcat项目服务器2:192.168.50.139</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">redis服务器：192.168.50.140</span></p><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(0, 82, 255); box-sizing: border-box !important; word-wrap: break-word !important;">注意访问时需要配置防火墙规则，或者关闭防火墙</span></p></blockquote><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">首先进行的通用安装：</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">总的需要模拟五台服务器，使用vmware，全部使用centos6.5 64位，五台服务器全部安装jdk，我使用的是jdk1.8.</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">1、安装VMware虚拟机，安装linux系统，此处使用centOS6.5 64位，安装linux命令行工具，上传文件工具，此处使用SecureCRT，SecureFX 。安装教程不再赘述，百度一大堆..........<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">这步有问题请使劲点：www.baidu.com</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.5109375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE296qJcB8EbW42IezhJpHafSUwPMl5u9ibuxemVx9ZpeljL016lfiapROyw/640?wx_fmt=png" data-type="png" data-w="640" height="398" width="783" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 189.04687500000003px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.4734375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29qafRUibpkuicIYdbdTrVv71taZbXYibCBbWb03UoO8ia0icyM3hrwIibrsgw/640?wx_fmt=png" data-type="png" data-w="640" height="371" width="784" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 175.171875px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">2、在linux上安装jdk:</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">安装jdk：卸载openjdk版本，上传解压jdk，配置环境变量----参考：http://jingyan.baidu.com/article/ab0b56308966acc15afa7d18.html</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(171, 25, 66); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">一、Nginx反向代理与负载均衡：</span></strong></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">架构图：</span></strong><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img width="907" height="475" class=" img_loading" data-type="png" data-ratio="0.5241379310344828" data-w="1015" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29rnmv1bfFyo8sLdIzhMQrlibqySEQzlJmTqpTAjdbuiaLMYKnt7kLiapVg/0?" style="max-width: 900px; border: 0px; height: 193.93103448275863px !important; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important;" _width="670px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">此时需要用到三台服务器，一台nginx服务器，两台正式部署项目的服务器：选择的是192.168.50.133主nginx和192.168.50.137,192.168.50.139两台tomcat服务器</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">首先在两台服务器上安装tomcat：这个也是简单，不多说</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">安装tomcat：</span></strong><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">上传解压即可使用，bin目录下 startup.sh启动，shutdown.sh关闭</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">配置防火墙端口：vim /etc/sysconfig/iptables 编辑，开放8080端口，80端口等一些常用端口，当然后边有用到一些端口都是需要配置开放的，不建议关闭防火墙<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.33125" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29icd1cXtAXKNOS0VmFo8seL0XvPUcel3NTKAj8iciaLDXpKPQ7MN9MibepQ/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 122.5625px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">编辑好后 service iptables restart 重新加载防火墙配置</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.14802065404475043" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29yHDKNDPzYCDhpV20nbqUWY6dTibBic9vruuCxRsyib9G8sI7LAlBrhGHg/640?wx_fmt=png" data-type="png" data-w="581" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 54.76764199655766px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">如果是自己测试嫌配置麻烦，关闭防火墙： service iptables stop 重启后防火墙打开，即在此次开机状态下有效，完全关闭再使用 chkconfig iptables off ,即会在重启后也关闭防火墙，注意有时候服务都起了但访问出错，可能就是防火墙问题哦</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">启动tomcat访问：192.168.50.137:8080，192.168.50.139:8080，打开tomcat首页即成功。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">然后编写测试项目，部署到两台tomcat上，eclipse新建web项目，项目名为testproject，在webapp下新建一个jsp页面为index.jsp,添加如下内容</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.3265625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29lp7QtIuYDdn7aeWue8uusTPZXfKJluSMggoEN3rLHradiagqtAw3GaQ/640?wx_fmt=png" data-type="png" data-w="640" height="359" width="1101" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 120.82812499999999px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">将项目中web.xml中的访问顺序&lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt;上移到第一个访问</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">然后右键导出为war包，testproject.war，将该war包上传到两台服务器的tomcat的webapps中</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.48598130841121495" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29bf7J5IAYwrMOAicdJhoCDRfJSfeBYfTibe82Bh3ibKLcxbWZ2Nes8YgicQ/640?wx_fmt=png" data-type="png" data-w="535" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 179.81308411214954px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 然后修改tomcat的server.xml文件，在tomcat conf目录中：可以使用notepad++的插件NppFTP直接连上linux，然后使用notepad++修改文件哦，保存记得使用UTF-8无BOM格式，具体去百度吧，哈哈<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">修改Engine标签中，添加jvmRoute，用于标识nginx访问的是哪个服务器tomcat，137服务器标识为137Server1，139服务器标识为139Server2</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2015625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29ajkpmiayU2bLG4RJicVqhWRG8OCygKZtghcx0ekQibiaIYYEYmKHaFcaxA/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 74.578125px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在两台tomcat的server.xml文件，Host标签中添加：&lt;Context path="" docBase="testproject"/&gt;，path标识访问路径，docBase为项目名，表示访问项目</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.3875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29mH6In6UywcIFJPOBNVYZ4buCubxP7d6jmsaAgViaunR757JN2mictEnQ/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 143.375px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">此时，重新启动tomcat，访问192.168.50.137:8080，192.168.50.139:8080,显示index.jsp内容：两台服务器访问显示如下</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span><img class=" img_loading" data-ratio="0.2765625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE298IQRq4JTNdopibklzaGKvTbm47iaUXZr7VaFkxS4pk5NzVpMqfTR0tsg/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 102.328125px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2671875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29EHfpeic8RxlfSzdJwyJ0fxSITvof7DVD77hGpDSGvBicNoZ3gbw7KYMA/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 98.85937500000001px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">至此，两台tomcat服务器搭建完成。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在nginx主机192.168.50.133上安装nginx：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">先使用yum命令安装gcc，安装pcre，zlib，openssl：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">yum install -y gcc   
yum install -y pcre pcre-devel   
yum install -y zlib zlib-devel   
yum install -y openssl openssl-devel<span style=" max-width: 100% ; ; ; ; ; ; ; ; ; ; ">plain</span></code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 在/usr/local/目录下新建nginx-src目录，将nginx-1.8.0.tar.gz放到此处，解压 </span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">tar -zxvf nginx-<span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">1.8.0</span>.tar.gz</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">进入解压后目录</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.3116883116883117" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29RSPH1g5KqQdgyN5OdYYYGzpgRQlg62pzXAxkSwrR8ESckOUSBCvg6Q/640?wx_fmt=png" data-type="png" data-w="616" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 115.32467532467533px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">依次执行命令：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">./configure   

make   

mkae install</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 此时nginx安装完毕，安装目录是/usr/local/nginx，nginx默认占用80端口</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.4265625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29mWc00yLqcWgd3UAZdbvDv0ZGxPuYcxShqzRYjslD9Lk8RVlIdDLc6g/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 157.828125px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">其中，sbin目录为nginx执行命令，conf目录下的nginx.conf为默认加载的配置文件</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">启动nginx：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">./sbin/nginx</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">关闭nginx：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">./sbin/nginx -s stop</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 启动nginx后访问192.168.50.133:80即可访问nginx：显示nginx欢迎页</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.38207547169811323" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29jA441kFAYxEUruHLiaPDh8XBUicwvurdBW8uKhLhEm2g29Lvc2AJ2kAA/640?wx_fmt=png" data-type="png" data-w="636" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 141.3679245283019px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 至此，nginx安装完毕。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">3、反向代理与负载均衡配置</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">现有两台服务器，一台为192.168.50.137，一台为192.168.50.139，服务器上各有一台tomcat，端口均为8080，在192.168.50.133上有nginx，经过配置nginx，当访问192.168.50.133:80时，即可访问192.168.50.137:8080，192.168.50.139:8080中随机一台，此时192.168.50.133:80被nginx监听，当有请求时，代理到192.168.50.137:8080，192.168.50.139:8080随机一台即可，即为nginx反向代理功能，同时此时可以通过nginx将请求进行转发，保证了一个入口，将所有请求转发到两台服务器上也减轻了任何一台的负载压力，当有大量请求时，可以搭建大量服务器，在入口代理服务器上使用nginx进行转发，即是负载均衡功能。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span><img data-ratio="NaN" data-w="0" style="max-width: 900px; border-width: 0px; border-style: initial; border-color: initial; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 配置即是配置nginx安装目录中conf目录下的nginx.conf文件即可：具体配置如下，重点是红色部分</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="1.20997375328084" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29PJajX6vPMo3ILtapkciaAichibDywrYWXVcJGfWJSNE5HKtcr5yXXAe8g/640?wx_fmt=png" data-type="png" data-w="381" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 447.6902887139108px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><img data-ratio="0.9981060606060606" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29NcWoUdAThjonBUicqABQGAzuK69yiaLBwIicE8cbgXVq7mqwIN9ibkTiazw/640?wx_fmt=png" data-type="png" data-w="528" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 369.2992424242424px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><img data-ratio="0.8651315789473685" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29JAfYj89kl50TKQPDDYYZvukK3u7ibOP6z31KU2PEXsopyzlfGyxlquA/640?wx_fmt=png" data-type="png" data-w="608" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 320.09868421052636px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><img data-ratio="0.6813725490196079" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29OkKwEeulqrL467O0OqoUcBtLw1paRODWTHtToicOuTUicgQXa1gibq7sw/640?wx_fmt=png" data-type="png" data-w="408" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 252.10784313725492px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">启动两台tomcat，重新启动nginx：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">访问192.168.50.133:80将会随机访问192.168.50.137:8080和192.168.50.139:8080其中一台。（问题：每次刷新nginx服务器地址sessionid会变，session不能共享。）</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2796875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29SVVEqzj8ThRf1iaErIic0zzNLaQnEwGlicqeMVjFWRyUbhSicyJZlb9Xrg/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 103.48437499999999px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">nginx轮询策略：</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">nginx负载均衡到多台服务器上时，默认采用轮询策略：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">常见策略：</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">1、轮询</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">2、weight</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况，数字越大命中率越高。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>例如：轮询几率是2:1</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><blockquote style="font-size: 16px; white-space: normal; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">upstream bakend {<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>server 192.168.0.14 weight=2;<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>server 192.168.0.15 weight=1;<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>}</span></p></blockquote><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">2、ip_hash</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">例如：</strong></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></strong></span></p><blockquote style="font-size: 16px; white-space: normal; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">upstream bakend {<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>ip_hash;<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>server 192.168.0.14:88;<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>server 192.168.0.15:80;<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>}</span></p></blockquote><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">其他策略可以自行查询学习,nginx还有很多其他可配置项，静态资源缓存，重定向等，想深入的童鞋请自行学习<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">nginx配置详解：http://blog.csdn.net/tjcyjd/article/details/50695922</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">实际问题：虽然解决了，但是不是很理解，记录一下</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">其中192.168.50.133:80是有外网映射的，外网55.125.55.55:5555映射到192.168.50.133:80上，此时使用55.125.55.55:5555访问，会映射到192.168.50.133:80上，然后会被转发到192.168.50.137:8080或192.168.50.139:8080，但是此时却出现图片，js，css等静态文件无法访问的情况，通过两种方法解决。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">&lt;1&gt;.映射非80端口</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">让55.125.55.55:5555映射192.168.50.133的非80端口，例如55.125.55.55:5555映射192.168.50.133:5555，然后再在nginx配置文件中配置如下，注意红色加大部分：这地方不理解</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="0.9982363315696648" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE293VXqbqviaGxeouO9qDIOeLib92INEt1eiclBv9chYzdKHDD7zTcpQnqNA/640?wx_fmt=png" data-type="png" data-w="567" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 369.347442680776px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="0.2845528455284553" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29hIOIk6biaGQhMVODo1kru2m9fOru8eU3doNuxKSD5kxGqNnicF8zFanw/640?wx_fmt=png" data-type="png" data-w="369" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 369px !important; visibility: visible !important; height: 105px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 此时访问55.125.55.55:5555，映射到192.168.50.133:5555上，然后转发到192.168.50.137:8080或192.168.50.139:8080上，此时静态文件均能访问。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> &lt;2&gt;.使用域名在外网服务器上使用nginx进行转发</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">将55.125.55.55绑定域名为test.baidubaidu.com，此时在55.125.55.55服务器上使用nginx,</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">........location / {   
        <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#加入判断，如果域名为test.baidubaidu.com，转发到192.168.50.133:80，然后再进行转发，注意，此处未进行测试，貌似是这么写的，$hostname为nginx变量，可以获取域名       </span>
        <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">if</span>(<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$hostname</span> = <span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"test.baidubaidu.com"</span> ){   
        　　proxy_pass http:<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">//192.168.50.133:80;   </span>
        }   

        <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#proxy_redirect          off;   </span>
        <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#非80端口使用，目的是将代理服务器收到的用户的信息传到真实服务器上，我也不是很理解   </span>
        proxy_set_header        Host <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$host</span>;   
        proxy_set_header        X-Real-IP <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$remote_addr</span>;   
        proxy_set_header        X-Forwarded-<span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">For</span> <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$proxy_add_x_forwarded_for</span>;   
        client_max_body_size    <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">10</span>m;   
        client_body_buffer_size <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">128</span>k;   
        proxy_connect_timeout   <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">300</span>;   
        proxy_send_timeout      <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">300</span>;   
        proxy_read_timeout      <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">300</span>;   
        proxy_buffer_size       <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">4</span>k;   
        proxy_buffers           <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">4</span> <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">32</span>k;   
        proxy_busy_buffers_size <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">64</span>k;   
        proxy_temp_file_write_size <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">64</span>k;   
        add_header Access-Control-Allow-Origin *;   
            }........</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">以上即nginx反向代理与负载均衡介绍，经过此次学习，发现nginx确实是博大精深，一个配置文件搞得我不要不要的。。。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(171, 25, 66); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">二、session共享问题：</span></strong></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">由于nginx是随机分配请求，假设一个用户登录时访问网站登录时被分配到192.168.50.137:8080上，然后进行了登录操作，此时该服务器上就会有该用户登录的session信息，然后登陆后重定向到网站首页或个人中心时，此时如果被分配到192.168.50.139:8080上，那么这台服务器上没有该用户session信息，于是又会变成未登录状态，所以由于nginx的负载均衡会导致session共享的问题。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">解决方法：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">1、nginx提供了ip_hash策略，可以保持用户ip进行hash值计算固定分配到某台服务器上，然后只要是该ip则会保持分配到该服务器上，保证用户访问的是同一台服务器，那么session问题就不存在了。这也是解决session共享的一种方式，也称为黏性session。但是假设一台tomcat服务器挂了的话，那么session也会丢失。所以比较好的方案是抽取session。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">2、session存在memcache或者redis中，以这种方式来同步session，把session抽取出来，放到内存级数据库里面，解决了session共享问题，同时读取速度也是非常之快。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.571875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29eCqhRSmoB49vMfOSn90gwQpAAlbqhLzNMiaGNrHIzxic9WsluS2MbEVA/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 211.59375px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">本例中：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.4421875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29n2aAJJ5aZQU8UxENUmu31gV4oaef36tclaYRztPdbAWJNje3EZ109Q/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 163.609375px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">Redis解决session共享：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在redis服务器192.168.50.140上搭建redis，redis默认端口为6379</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">Redis搭建：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">redis依赖gcc，先安装：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">yum install -y gcc-c++</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">下载redis，我使用的是redis-3.2.1.tar.gz，上传至linux /usr/local/redis-src/中，解压</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">进入解压后目录redis-3.2.1，执行make命令进行编译</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">安装到目录/usr/local/redis</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">执行：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">make PREFIX=/usr/local/redis install</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">安装完成之后将redis配置文件拷贝到安装目录下，redis.conf是redis的配置文件，redis.conf在redis源码目录,port默认6379。</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">执行命令：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">cp /usr/local/redis-src/redis-<span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">3.2.1</span>/redis.conf /usr/local/redis/</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">在redis安装目录启动和关闭redis：</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">启动：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">./bin/redis-server ./redis.conf</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2390625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29k6f8xCezq5sZQptC7D0fUPU8icfumh8bsItR72HU9oeUtn5a7xZzkoQ/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 88.453125px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">这种启动方式叫做前端启动，必须保持在当前窗口，如果ctrl + c 退出，那么redis也就退出了，不建议使用</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">那么后端启动：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">首先修改redis.conf中daemonize的值，打开可以看到默认是no，修改为daemonize yes，启动即可。也可以在该配置文件中修改redis默认端口6379为其他值。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2796875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29s4A55uWxpv0ngQhs75QuWaZHibvyHia2Ctt4ibupicticKtbcHqZPx0r1hg/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 103.48437499999999px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">关闭redis：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">./bin/redis-cli shutdown</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 至此，redis服务器搭建完成。</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">tomcat与redis集成实现session共享：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">环境为tomcat7 + jdk1.6的话：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在所有需要共享session的服务器的tomcat中目录下：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">lib目录中添加以下三个jar包，注意版本最好一致，不然极容易出现错误，下边的测试是可用的：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.15368852459016394" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29oXfCiarfBxjblQyInMEJeY1LfdiaPT6NGV8IKkY8yLSF665JNbepFC4A/640?wx_fmt=png" data-type="png" data-w="488" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 56.864754098360656px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">conf目录中content.xml中加入：配置redis服务</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="0.2257495590828924" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29lD7HL0QZj8ZQCOXxo23nTCaRyK4OYSFHy12icicFZvNYOty2I17222Ig/640?wx_fmt=png" data-type="png" data-w="567" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 83.52733686067019px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">环境为tomcat7 + jdk1.7或1.8的话：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在所有需要共享session的服务器的tomcat中目录下：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">lib目录中添加以下三个jar包，测试通过：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.20476190476190476" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29my81M7sH5EEnplbWiakOhHHdjycic5DKvquA4tA83qvPPEoAk9HGeW6w/640?wx_fmt=png" data-type="png" data-w="420" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 75.76190476190476px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">conf目录中content.xml中加入：配置redis服务</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="0.20195439739413681" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29okkbHdCVZ4Te18qfOiagXI48ZefgtQk379no8OphrQ4oy2uTTZdFaoA/640?wx_fmt=png" data-type="png" data-w="614" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 74.72312703583061px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">根据我这测试，是jkd1.8+tomcat7，在137和139两台tomcat中加入jar包且进行如上配置：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">上传jar包</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.515625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29d98n0h1iam8UyGQ6xTZRmtDajK8SFg9GcMygt5mNrR4lQfaFkyMBkRw/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 190.78125px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 修改content.xml</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.5265625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29gUP0VwGX9mqlpmXqvruSLibklicjiad1n0k7QaJjT7G2ovnmEmbNviaUGA/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 194.82812500000003px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">启动redis服务，重新启动所有tomcat，启动nginx，刷新nginx页面,两台tomcat页面可以看到sessionid值不变，关闭某台tomcat，nginx中sessionid不变，说明session是共享的。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">问题：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">有可能此时访问会报错，redis无法访问，这是由于redis的安全机制，默认只有127.0.0.1才能访问，在redis.conf中可以找到bind 127.0.0.1，你可以将此ip改为访问者ip，</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">如果有多个访问者，也可以把bind 127.0.0.1注释掉，然后在配置文件中找到protected-mode，修改protected-mode yes改为protected-mode no 关闭redis保护模式即可</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">详细可以参考这：http://www.cnblogs.com/liusxg/p/5712493.html</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">经过大牛指点：添加两个注意点：</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">1、按照如上配置,使用redis数据库,放入session中的对象必须要实现java.io.Serializable接口，使用memcache的可以不用实现Serializable接口</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">原因是:因为tomcat里使用的将session放置redis使用的工具类,是使用的jdk序列化模式存储的，这一点也是很容易理解的，session.setAttribute(String key, Object value)，存储Object类型</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">object放入redis中又要能取出来，只能是序列化进行存储了，然后取出的时候进行反序列化。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">所以我们在session中存储的任何对象，都必须实现序列化接口。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">2、按照如上配置,使用redis做session存储空间时,web应用的session-time的时间单位会变成[秒],而不是原本的[分]</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">原因是:因为tomcat里使用的将session放置redis使用的工具类,在存储时为对tomcat容器时间做转换，</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在redis中设置过期时间是使用秒作为单位的，有个命令叫expire可以设置redis键值过期时间，所以在context.xml配置文件中我们需要制定session过期时间（默认是60秒，配成1800即30分钟），这一点很重要。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">请注意！！！！</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">context.xml配置说明：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="0.2921875" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29ibFa0suhSD5zVjbburCXdvtLK2LTWyqaPxFIdXpenf15t1TqiaIHTabA/640?wx_fmt=png" data-type="png" data-w="640" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 108.109375px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(171, 25, 66); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">三、keepalived高可用：</span></strong></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">架构图：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="0.475" data-src="http://mmbiz.qpic.cn/mmbiz_jpg/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29us1EpuKjc1ic7pe4odNm5drba9AUvf2fj6EQvkFxcHmia0YJcMx3R0Dw/640?wx_fmt=jpeg" data-type="jpeg" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 175.75px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">上图画的不对称好难看，将就下吧</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">根据上边一路走来，已经是搭好了从nginx主到服务器的这条线的，那么同理，使用nginx备机192.168.50.135上再搭建nginx，也是代理192.168.137和139两台服务器。搞了一次之后也就简单了</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在192.168.50.135上安装nginx，配置nginx配置即可，不再赘述，nginx备机配置如下：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">配置和上边的是一样的，只不过监听的地方的ip了而已</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="1.148997134670487" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29hdXiaBV4ZTicMDSGnBKU3JhO82IWREtI0ou5vc7Ytfa9hzy9hr6aJUfA/640?wx_fmt=png" data-type="png" data-w="349" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 349px !important; visibility: visible !important; height: 401px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">那么现在就是相当于有两套nginx了，代理的服务器是一样的，为什么要搞两套？</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">假设只有一台nginx的话，这个nginx服务器挂了。那怎么办？</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">所以需要一台备份nginx。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">正常情况下，主nginx作为反向代理服务器即可，假设nginx服务器挂了的话，能够立即切换到备份机上，保证用户可以访问，然后运维人员把主nginx服务器故障修好之后，又能够自动切换到主nginx提供服务。通过keepalived来监测两台服务器，正常情况时，将nginx主服务器ip（192.168.50.133）绑定到keepalived定义的一个虚拟ip（我设置为192.168.50.88）上，通过这个虚拟IP可以访问nginx，然后备机（192.168.50.135）啥事不干，就是每隔一小段时间（设置为1秒）keepalived会告诉备机，你不用管，我还活着呢，如果突然主机死了，那么就会超过一秒备机没有收到主机或者的消息，那么备机马上接管主机，keeplived将虚拟ip绑定到备机身上，网站继续提供服务。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">突然主机又复活了（运维人员排除故障了），那么备机又将收到主机的活着的消息，于是将管理权交回给主机，虚拟ip又绑到主机上，大概就是这么个过程，个人理解。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.5796875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29Z6QTufUFfibxrQic7EpzkqjRFpsSiaibplxO8Zz21NwhE2tyErVW3yeUbA/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 214.484375px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 先在两台nginx服务器（主备）上都装上keepalived：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 下载：这里使用rpm安装，是区分32,64位的，不要搞错了哦</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">keepalived-1.2.7-3.el6.x86_64.rpm</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">openssl-1.0.1e-30.el6_6.4.x86_64.rpm</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">要求必须是openssl-1.0.1e或以上才行、如果版本已经符合（因为安装nginx时已经安装openssl，使用yum安装应该是符合的）、不用再安装openssl，使用 rpm -q openssl 查看当前openssl版本，我这已经是1.0.1e 48的，所以就不安装了</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class="" data-type="png" data-ratio="0.07729468599033816" data-w="414" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29EECfWJyvW2rOpew4ia6iciaG2dBplqbnOXVqFGaw6ibCksxaBaSz8c4xRg/0?" style="max-width: 900px; border: 0px; height: 28.59903381642512px !important; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important;" _width="414px" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">将两个rpm安装包上传到两台nginx服务器，进入上传到的目录，运行以下命令安装:--nodeps是忽略依赖包，当然最好是把依赖包装上，去掉--nodeps可以看到错误，需要哪些依赖包</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">如果需要安装openssl</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">rpm –Uvh --nodeps ./openssl-<span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">1.0.1e-30</span>.el6_6<span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">.4</span>.x86_64.rpm</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 安装keepalived：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;"> rpm -Uvh --nodeps ./keepalived-<span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">1.2.7</span>-<span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">3.</span>el6.x86_64.rpm</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">安装完毕后再/etc/keepalived/目录下有个文件 keepalived.conf即是本台服务器keepalived的核心配置文件了：</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">重点：keepalived配置，配置文件上边部分按照下面的配置就行了，配置文件后面的内容可以不用管，还没有去研究其他部分</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">先配置主机192.168.50.133的keepalived，按下边进行配置</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="0.940625" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29zOyor86LtgMc9F1FnTbZRsUGkiaLRyCtPjt04PFjsSa3AWyFBRfhmeA/640?wx_fmt=png" data-type="png" data-w="640" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 348.03125px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> <img data-ratio="0.5523465703971119" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE295U9PCRRm388eXrAnJQeudHUG59j4C4l9gm1XEpLRenGFQOIr8HtjKA/640?wx_fmt=png" data-type="png" data-w="554" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 204.36823104693138px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">备机192.168.50.135的keepalived配置：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">备机配置注意的地方：需要修改state为BACKUP , priority比MASTER低，virtual_router_id和master的值一致</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><img data-ratio="1.3771289537712896" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29RmG5XqURg2nvF2XRsnGtaJvOaytDSOQmK61I7ksopqriblNOTiaMGlkg/640?wx_fmt=png" data-type="png" data-w="411" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 509.5377128953772px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><img data-ratio="0.6904761904761905" data-s="300,640" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29ibBrD5kD86VeBgSj7rHd2dl4ZQrx5k3dLmvTLUHcfvGMCYVCLVj01ag/640?wx_fmt=png" data-type="png" data-w="462" style="box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 255.47619047619048px !important;" _width="auto" class=" img_loading" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">酱紫，keepalived就配置完成了。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">keeplived启动关闭命令：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;"> service keepalived start   
service keepalived stop</code></pre><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;"> service keepalived start   
service keepalived stop</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">启动两台nginx，启动主机keepalived，启动备机keepalived服务。</span><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">这时，nginx主机在提供服务，备机是闲着的，虚拟ip是192.168.50.88，在主机和备机上使用命令</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">ip addr</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 可以发现：</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">主机：可以看到，192.168.50.133 带有虚拟ip192.168.50.88，在浏览器中输入192.168.50.88，即可访问到主nginx192.168.50.133.然后转发到tomcat服务器上</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.234375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29YjXe1JS0BXxxIpGvV3CicpIvZfIWOPRHcwGk0AR6Pm8yjlgrwgpvWvw/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 86.71875px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">浏览器访问虚拟ip：192.168.50.88，效果如下<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.271875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29oRw8gAMLRcwueuHPwGGZeVDgpHN0TymtiaCyeazQvcLYXBC9dKibnmlw/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 100.59374999999999px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">备机：ip addr命令执行：可以看到，备机nginx没有绑定虚拟ip</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2265625" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE295qicHtho8Kb3UbwyiaWvRM94tDYHsncibIWMibsCFBkTYRoIzzdCdSibtPw/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 83.828125px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 以上是初始状态下的情况，也是正常服务的情况。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">现在测试高可用，假设主机nginx服务器挂了，模拟为关闭nginx主机或者将keepalived服务停止，那么主机上keepalived死了就没办法告诉备机自己活着，而备机超过1秒没有接收到主机给自己的消息，马上接管虚拟ip，同时在配置文件中配置切换主备机时发送邮件，此时开发团队收到邮件即知道主机挂了，马上去排除主机的故障。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">将主机上的keepalived服务停止，service keepalived stop ,然后查看虚拟ip绑定情况，</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">主机挂了：可以看到虚拟ip就没有绑在主机上<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2546875" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29Ud3yiclP0I210FaI3nHWKu7jtaZCTT6pqKnibUYwb99JYh1cVFPMrUYg/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 94.234375px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">备机情况：虚拟ip已经绑定到备机，此时主机虽然挂了，但是切换到备机上了（发现故障和切换的时间差最大也就是1秒），虚拟ip也绑到备机上了，访问虚拟ip，就会请求备机nginx然后转发到web服务器实现高可用。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span><img class=" img_loading" data-ratio="0.259375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29ChszkmuESC2KaHFlmHG80mHdja1uE6JjpZKArcNTBsg9KHibSDNVD9g/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 95.96875000000001px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 运维人员收到邮件后就去排除主机故障了，搞定之后（模拟为keepalived服务启动），这时主机告诉备机，我又活了，于是备机将管理权又交给主机（切换为主机nginx提供服务）：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">主机keepalived服务启动后，即吧主机维护好之后：可以看到，虚拟ip又自动绑到了主机上</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span><img class=" img_loading" data-ratio="0.2609375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29MgpplAmzasQ9TjZvRwB7T4Utb9RWzD48RU9X6HETp12JB4cicbedU1Q/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 96.546875px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 备机情况，主机活了之后，备机转交管理权，虚拟ip切换到主机上，备机不绑定虚拟ip,貌似启动keepalived服务之后并不能马上切回，应该是起服务需要点时间吧，但是不影响，这段时间还是备机绑定虚拟IP的</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.234375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29UkgicbfSvfwcznO1jYGe16elastx45JVJYibWibvuYlG6DgCfYxSaM93g/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 86.71875px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 这就是keepalived高可用的模拟。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">注意问题：</span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">主机挂了之后，主机nginx恢复时，一定要将nginx也启动，否则即使虚拟ip切换到了主机上，但是主机nginx没起那也是没法转发的。所以要把nginx启动要加在开机启动中。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></strong></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(171, 25, 66); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">四、Nginx服务开机自启动：</span></strong></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在linux系统的/etc/init.d/目录下创建nginx文件，使用如下命令：（vim命令不会的自己去学吧哈哈）</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">vi /etc/init.d/nginx</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">将如下内容搞到该文件中:注意红色部分修改成你的路径即可，nginxd值是启动nginx的nginx路径，nginx_config值是nginx配置文件nginx.conf路径，nginx_pid值是nginx.pid所在路径，如果按照我方法安装的话，是在nginx安装目录的logs里边的</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;"><span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#!/bin/bash   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/># nginx Startup script for the Nginx HTTP Server   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/># it is v.0.0.2 version.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/># chkconfig: - 85 15   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/># description: Nginx is a high-performance web and proxy server.   #              <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>It has a lot of features, but it's not for everyone.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/># processname: nginx   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/># pidfile: /usr/local/nginx/logs/nginx.pid   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/># config: /usr/local/nginx/conf/nginx.conf   </span>n<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>ginxd=/usr/local/nginx/sbin/nginx   
nginx_config=/usr/local/nginx/conf/nginx.conf   
nginx_pid=/usr/local/nginx/logs/nginx.pid   
RETVAL=<span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">0</span>   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>prog=<span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"nginx"</span>   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;"># Source function library.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span>. /etc/rc.d/init.d/functions   
<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;"># Source networking configuration.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span>. /etc/sysconfig/network   
<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;"># Check that networking is up.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span>[ ${NETWORKING} = <span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"no"</span> ] &amp;&amp; <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">exit</span> <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">0</span>   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>[ -x <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$nginxd</span> ] || <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">exit</span> <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">0</span>   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;"># Start nginx daemons functions.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span>start() {   
<span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">if</span> [ -e <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$nginx_pid</span> ];then   
   <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span> <span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"nginx already running...."</span>   
   <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">exit</span> <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">1</span>   fi   
   <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span> -n $<span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"Starting $prog: "</span>   
   daemon <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$nginxd</span> -c ${nginx_config}   
   RETVAL=$?   
   <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span>   
   [ <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$RETVAL</span> = <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">0</span> ] &amp;&amp; touch /<span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">var</span>/lock/subsys/nginx   
   <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">return</span> <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$RETVAL</span>   }   
<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;"># Stop nginx daemons functions.   </span>stop() {   
        <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span> -n $<span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"Stopping $prog: "</span>   
        killproc <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$nginxd</span>   
        RETVAL=$?   
        <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span>   
        [ <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$RETVAL</span> = <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">0</span> ] &amp;&amp; rm -f /<span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">var</span>/lock/subsys/nginx /<span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">var</span>/run/nginx.pid   
}   
<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;"># reload nginx service functions.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span>reload() {   
    <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span> -n $<span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"Reloading $prog: "</span>   
    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#kill -HUP `cat ${nginx_pid}`   </span>
    killproc <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$nginxd</span> -HUP   
    RETVAL=$?   
    <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span>   }   
<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;"># See how we were called.   <br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span><span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">case</span> <span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"$1"</span> in   
start)   
        start   
        ;;   
stop)   
        stop   
        ;;   
reload)   
        reload   
        ;;   
restart)   
        stop   
        start   
        ;;   
status)   
        status <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$prog</span>   
        RETVAL=$?   
        ;;   
*)   
        <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">echo</span> $<span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"Usage: $prog {start|stop|restart|reload|status|help}"</span>   
        <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">exit</span> <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">1</span>   esac   
<span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">exit</span> <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$RETVAL</span></code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">然后设置该文件的访问权限：执行以下命令，意为所有用户可访问</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">chmod a+x /etc/init.d/nginx</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"> 最后将ngix加入到rc.local文件中，这样开机的时候nginx就默认启动了</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">vi /etc/rc.local</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">添加</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">/etc/init.d/nginx start</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.35737704918032787" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29Rh6BCEicehaoqOSlxPZnEErV1VibIST1sFCX1mkYPS7iaQbymZF7oYl5Q/640?wx_fmt=png" data-type="png" data-w="610" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 132.2295081967213px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">保存并退出，下次重启就会生效，nginx的开机自启动。测试无误的。<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(171, 25, 66); box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">四、解决nginx进程和keepalived不同时存在问题:</span></strong></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">keepalived是通过检测keepalived进程是否存在判断服务器是否宕机，如果keepalived进程在，但是nginx进程不在了，那么keepalived是不会做主备切换。因为是nginx挂了，然后无法做代理，keepalived还在不会切换到备机。<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">所以一直检测nginx是否还在，如果不在，那么让keepalived也停止，同生共死。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">注：只需要在主机上搞就行了，备机没必要检测nginx，因为基本是主机在服务。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">解决：写个脚本来监控nginx进程是否存在，如果nginx不存在就将keepalived进程杀掉。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">注：keepalived不需要开机启动，假如开机自启的话，如果keepalived比nginx 更快启动的话，脚本检测会把keepalived停掉的，所以没必要，只需要nginx开机启动，启动主机后自行手动的把keepalived服务启动即可。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">在主nginx上编写nginx进程检测脚本（check_nginx_dead.sh）,在keepalived配置文件目录下创建脚本:</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">vi /etc/keepalived/check_nginx_dead.sh</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">把下边这些内容搞到脚本文件中，内容如下：</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;"><span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#!/bin/bash# 如果进程中没有nginx则将keepalived进程kill掉</span>A=`ps -C nginx --no-header |wc -l`      <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">## 查看是否有 nginx进程 把值赋给变量A</span><span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">if</span> [ <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">$A</span> -eq <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">0</span> ];then                    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">## 如果没有进程值得为 零</span>
       service keepalived stop          <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">## 则结束 keepalived 进程</span>f</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">给访问权限：不然不行哦，这里卡了我半小时</span></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">chmod a+x /etc/keepalived/check_nginx_dead.sh</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">先测试一下脚本：</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">把nginx停了，此时keepalived还在运行，所以不会切换，虚拟ip无法访问到web服务器</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.29375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29BjqGbbcDBQuicgw13WtOSsucgzGvgparZmYtBaeqwXYwH383d98vynw/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 108.6875px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">然后执行脚本：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">主机脚本检测nginx不在了，把keepalived停掉，从输出可以看到确实停止了，主机虚拟没有绑定虚拟ip</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2578125" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29erYxxBUD6F60SstjhDoGOoj2FYaibAGd6t5qrrQdP6orQNDE6f3Q3rQ/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 95.390625px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">备机：成功绑定虚拟ip</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span><img class=" img_loading" data-ratio="0.2203125" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29Zh0wGDamvWwYQMxQPLh1U8ws47noyicrIpvLTJJnPES3syweeHOfUiaA/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 81.515625px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">所以，只需要让该脚本一直执行，即一直检测nginx进程是否在，如果没得了，那么直接停止主机keepalived，切换备机，保证能够访问web服务器。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">按如下修改keepalived配置文件keepalived.conf，添加脚本定义检测：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">只需要在正确的位置添加红色部分即可：那么脚本则是两秒执行一次，一旦发现主机nginx不在了，keepalived停止，切换备机</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><pre style="margin-top: 1.2em; margin-bottom: 1.2em; padding: 0px; background-color: rgb(255, 255, 255); font-size: 1em; max-width: 100%; color: rgb(62, 62, 62); font-family: Consolas, Inconsolata, Courier, monospace; line-height: 1.2em; box-sizing: border-box !important; word-wrap: break-word !important;"><code class="" style="margin-right: 0.15em; margin-left: 0.15em; padding: 0.5em; max-width: 100%; font-size: 0.85em; font-family: Consolas, Inconsolata, Courier, monospace; overflow: auto; border-radius: 3px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); color: rgb(248, 248, 242); background: rgb(35, 36, 31); box-sizing: border-box !important; word-wrap: break-word !important; display: block !important;">! Configuration File <span class="" style="max-width: 100%; color: rgb(249, 38, 114); box-sizing: border-box !important; word-wrap: break-word !important;">for</span> keepalived<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#这是全局配置</span>global_defs {   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#指定keepalived在发生切换时需要发送email到的对象，一行一个</span>
   notification_email {
     acassen@firewall.loc
     failover@firewall.loc
     sysadmin@firewall.loc
   }   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#指定发件人</span>
   notification_email_from Alexandre.Cassen@firewall.loc   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#指定smtp服务器地址</span>
   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#smtp_server 192.168.200.1</span>
   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#指定smtp连接超时时间</span>
   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#smtp_connect_timeout 30</span>
   <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#运行keepalived机器的一个标识</span>
   router_id LVS_DEVEL
}

vrrp_script check_nginx_dead {    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">##监控脚本路径</span>
    script <span class="" style="max-width: 100%; color: rgb(230, 219, 116); box-sizing: border-box !important; word-wrap: break-word !important;">"/etc/keepalived/check_nginx_dead.sh"</span>
    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">##时间间隔，2秒</span>
    interval <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">2</span>
    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">##权重</span>
    weight <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">2</span>                                            }<span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#主备配置</span>vrrp_instance VI_1 {    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#标示状态为MASTER 备份机为BACKUP</span>
    state MASTER    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#设置keepalived实例绑定的服务器网卡，一般为eth0，linux使用ifconfig命令可查看当前服务器网卡标识名</span>
    <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span class="" style="max-width: 100%; color: rgb(102, 217, 239); box-sizing: border-box !important; word-wrap: break-word !important;">interface</span> <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">eth0</span>
    #同一实例下（即同一组主备机下）<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">virtual_router_id</span>必须相同    <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">virtual_router_id</span> 51
    #<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">MASTER</span>权重要高于<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">BACKUP</span>，<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">MASTER</span>为100则<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">BACKUP</span>最大为99    <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">priority</span> 100
    #<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">MASTER</span>与<span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">BACKUP</span>负载均衡器之间同步检查的时间间隔，单位是秒，设置为1秒    <span class="" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">advert_int</span> 1
    #设置认证    <span class="" style="max-width: 100%; font-style: italic; box-sizing: border-box !important; word-wrap: break-word !important;">authentication</span> </span>{    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#主从服务器验证方式，PASS为明文密码验证</span>
        auth_type PASS    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#密码</span>
        auth_pass <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">1111</span>
    }

    track_script {    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#监控脚本</span>
        check_nginx_dead     
    }    <span class="" style="max-width: 100%; color: rgb(117, 113, 94); box-sizing: border-box !important; word-wrap: break-word !important;">#设置虚拟IP，与我们的主备机在同一网段下，最后一位随便给就是拉，可以设置多个，换行即可</span>
    virtual_ipaddress {        <span class="" style="max-width: 100%; color: rgb(174, 129, 255); box-sizing: border-box !important; word-wrap: break-word !important;">192.168.50.88</span>
    }
}</code></pre><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; line-height: 1.6; box-sizing: border-box !important; word-wrap: break-word !important;">保存后，重新启动主机keepalived服务即可。</span><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">测试：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">回到负载均衡高可用的初始状态，保证主、备上的keepalived、nginx全部启动。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">停止主nginx服务：</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">主机查看keepalived进程，发现没有，说明已经停止了，虚拟ip也没有绑在主机上</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><img class=" img_loading" data-ratio="0.2828125" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29jBdJtn0RdM1TQjcv1mSIHq3gtvrdT3HOPjsPGKWtfMtIXxgBykGwjw/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 104.64062500000001px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 备机：绑定虚拟ip，切换成功。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span><img class=" img_loading" data-ratio="0.2484375" data-src="http://mmbiz.qpic.cn/mmbiz_png/oGp3ImQqDoY3oAj4s1B2xdIc7jjxaE29w938UYdZQno0oM7gFZgHTMlQjpZBdK9svljnIBAI3GhEaur981ucmA/640?wx_fmt=png" data-type="png" data-w="640" style="max-width: 900px; border: 0px; box-sizing: border-box !important; word-wrap: break-word !important; width: 370px !important; visibility: visible !important; height: 91.921875px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="/></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> 测试通过，如果主机nginx挂了之后，keepalived也会随着挂掉，然后切换备机。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"> </span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">以上所有过程均是经过测试的，所以除去一些其他因素，例如人品，应该都是可以成功的。</span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/></span></p><blockquote style="font-size: 16px; white-space: normal; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><p style="max-width: 100%; min-height: 1em; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">经过大牛指点：添加两个注意点：</span></strong><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>1.按照如上配置,使用redis数据库,放入session中的对象必须要实现java.io.Serializable接口，使用memcache的可以不用实现Serializable接口<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>原因是:因为tomcat里使用的将session放置redis使用的工具类,是使用的jdk序列化模式存储的，这一点也是很容易理解的，session.setAttribute(String key, Object value)，存储Object类型<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>object放入redis中又要能取出来，只能是序列化进行存储了，然后取出的时候进行反序列化。<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>所以我们在session中存储的任何对象，都必须实现序列化接口。<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>2.按照如上配置,使用redis做session存储空间时,web应用的session-time的时间单位会变成[秒],而不是原本的[分]<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>原因是:因为tomcat里使用的将session放置redis使用的工具类,在存储时为对tomcat容器时间做转换，<br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/><br style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"/>在redis中设置过期时间是使用秒作为单位的，有个命令叫expire可以设置redis键值过期时间，所以在context.xml配置文件中我们需要制定session过期时间（默认是60秒，配成1800即30分钟），这一点很重要。</span></p></blockquote><p style="white-space: normal;"><br/></p><hr style="font-size: 16px; white-space: normal; line-height: 25.6px; max-width: 100%; color: rgb(62, 62, 62); background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"/><p style="font-size: 16px; white-space: normal; line-height: 25.6px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; white-space: pre-wrap; font-size: 14px; line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important;">●本文编号2327，以后想阅读这篇文章直接输入2327即可。</span></p><p style="font-size: 16px; white-space: normal; line-height: 25.6px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">●输入m可以获取到文章目录</span></p><section donone="shifuMouseDownCard('shifu_c_027')" style="margin-top: 2em; padding-top: 0.5em; padding-bottom: 0.5em; font-family: inherit; font-size: 1em; white-space: normal; line-height: 25.6px; max-width: 100%; color: rgb(62, 62, 62); border-radius: 4px; border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204); text-decoration: inherit; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><section style="margin-top: -1.8em; max-width: 100%; line-height: 1.4; color: rgb(166, 166, 166); text-align: center; border-width: initial; border-style: none; border-color: initial; box-sizing: border-box !important; word-wrap: break-word !important;"><section class="" style="padding: 8px 12px; max-width: 100%; border-radius: 4px; color: rgb(255, 255, 255); font-size: 1em; font-family: inherit; text-decoration: inherit; display: inline-block; border-color: rgb(183, 184, 184); background-color: rgb(70, 118, 217); box-sizing: border-box !important; word-wrap: break-word !important;"><section style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 18px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">本文内容的相关公众号推荐</strong></span></section></section></section><section style="padding: 16px; max-width: 100%; font-size: 1em; font-family: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><p style="margin-top: 5px; margin-bottom: 5px; max-width: 100%; min-height: 1em; font-weight: inherit; line-height: 25.6px; color: rgb(32, 32, 32); text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="font-size: 1em; line-height: 25.6px; font-family: inherit; text-decoration: inherit; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;">Web开发</strong><strong style="font-size: 1em; font-family: inherit; text-decoration: inherit; max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">↓<strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">↓</strong><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">↓</strong></strong><strong style="max-width: 100%; font-size: 1em; line-height: 25.6px; font-family: inherit; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"/></p><p style="margin-top: 5px; margin-bottom: 5px; font-weight: inherit; line-height: 25.6px; max-width: 100%; min-height: 1em; color: rgb(32, 32, 32); text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="font-family: inherit; font-size: 1em; max-width: 100%; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="font-family: inherit; font-size: 1em; max-width: 100%; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="font-family: inherit; font-size: 1em; max-width: 100%; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="font-family: inherit; font-size: 1em; max-width: 100%; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; font-family: inherit; font-size: 1em; line-height: 22.4px; text-decoration: inherit; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;"><img class="__bg_gif img_loading" data-ratio="1" data-src="http://mmbiz.qpic.cn/mmbiz/NVvB3l3e9aGfWsR2yrEFfe3M6ibOBgwiaa9pAmKLxROLpfAh23Ja7LXfD29yzbPTGK8vZn74YzBuZZmUpUBeiagvA/0?wx_fmt=gif" data-type="gif" data-w="200" width="auto" style="white-space: pre-wrap; color: rgb(62, 62, 62); line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 200px !important; height: 200px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-order="0"/></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p><p style="margin-top: 5px; margin-bottom: 5px; max-width: 100%; min-height: 1em; line-height: 25.6px; color: rgb(32, 32, 32); text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;"><strong>数据库开发<strong style="font-family: inherit; font-size: 1em; text-decoration: inherit; max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">↓<strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">↓</strong><strong style="max-width: 100%; line-height: 22.4px; box-sizing: border-box !important; word-wrap: break-word !important;">↓</strong></strong></strong></p><p style="margin-top: 5px; margin-bottom: 5px; max-width: 100%; min-height: 1em; line-height: 25.6px; color: rgb(32, 32, 32); text-align: center; box-sizing: border-box !important; word-wrap: break-word !important;"><img class="__bg_gif img_loading" data-ratio="1" data-src="http://mmbiz.qpic.cn/mmbiz/NVvB3l3e9aG7cylA9f13z7vnSfVrRx3WGfNC05yWYe4icIOmBajBcA3UnrtSERg5iamwJblGbZDhticZhLgd6wnQg/0?wx_fmt=gif" data-type="gif" data-w="200" width="auto" style="white-space: pre-wrap; color: rgb(62, 62, 62); line-height: 25.6px; box-sizing: border-box !important; word-wrap: break-word !important; visibility: visible !important; width: 200px !important; height: 200px !important;" _width="auto" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" data-order="1"/></p></section></section><p><br/></p><p style="font-size: 16px; white-space: normal; line-height: 25.6px; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); text-align: center; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">更多推荐</span><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;">《</span></strong><a href="http://mp.weixin.qq.com/s?__biz=MjM5NzA1MTcyMA==&amp;mid=402665544&amp;idx=4&amp;sn=4b9ec51c14d3d2969ba3c3aa5035a900&amp;scene=21#wechat_redirect" target="_blank" data_ue_src="http://mp.weixin.qq.com/s?__biz=MjM5NzA1MTcyMA==&amp;mid=402665544&amp;idx=4&amp;sn=4b9ec51c14d3d2969ba3c3aa5035a900&amp;scene=21#wechat_redirect" style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; color: rgb(255, 169, 0); box-sizing: border-box !important; word-wrap: break-word !important;">15个技术类公众微信</span></strong></a><span style="max-width: 100%; font-size: 14px; box-sizing: border-box !important; word-wrap: break-word !important;"><strong style="max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 16px; box-sizing: border-box !important; word-wrap: break-word !important;">》</span></strong></span></p><p style="font-size: 16px; white-space: normal; max-width: 100%; min-height: 1em; color: rgb(62, 62, 62); line-height: 1.75em; background-color: rgb(255, 255, 255); box-sizing: border-box !important; word-wrap: break-word !important;"><span style="max-width: 100%; font-size: 14px; color: rgb(136, 136, 136); box-sizing: border-box !important; word-wrap: break-word !important;">涵盖：程序人生、算法与数据结构、黑客技术与网络安全、大数据技术、前端开发、Java、Python、Web开发、安卓开发、iOS开发、C/C++、.NET、Linux、数据库、运维等。</span></p>
                    